(function() {
    'use strict';

    angular
        .module('pasp.ui.seed', [
            'pasp.ui',
            'ngAnimate',
            'ngCookies',
            'ngResource'
        ])
        .config(function($stateProvider, $urlRouterProvider) {
            $urlRouterProvider
                .otherwise('/');

            $stateProvider
                .state('/', {
                    url: "/",
                    templateUrl: "scripts/pages/home/home.view.html",
                    controller: 'HomeCtrl'
                })
                .state('table', {
                    url: "/table",
                    templateUrl: "scripts/pages/table/table.view.html",
                    controller: 'TableCtrl'
                })
                .state('form', {
                    url: "/form",
                    templateUrl: "scripts/pages/form/form.view.html",
                    controller: 'FormCtrl'
                })
                .state('article', {
                    url: "/article",
                    templateUrl: "scripts/pages/article/article.view.html"
                });
        });
})();

(function() {
    'use strict';

    /**
     * 头部(控制器)
     */
    angular.module('pasp.ui.seed')
        .controller('HeaderWrapCtrl', function() {
            
        });
})();
(function() {
    'use strict';

    /**
     * 头部(指令)
     */
    angular
        .module('pasp.ui.seed')
        .directive('uiHeaderWrap', function($rootScope, $cookieStore) {
            return {
                controller: 'HeaderWrapCtrl',
                replace: true,
                templateUrl: 'scripts/components/header-wrap/header-wrap.view.html'
            };
        });
})();
(function() {
    'use strict';

    /**
     * 左侧导航(控制器)
     */
    angular.module('pasp.ui.seed')
        .controller('SidebarCtrl', function(SidebarService, $rootScope, $scope, $location) {
            SidebarService.get('main').then(function(data){
                $scope.links = data.records;
            });
        });
})();
(function() {
    'use strict';

    /**
     * 左侧导航(指令)
     */
    angular
        .module('pasp.ui.seed')
        .directive('uiSidebar', function($location, $timeout) {
            return {
                controller: 'SidebarCtrl',
                restrict: 'EA',
                replace: true,
                templateUrl: 'scripts/components/sidebar/sidebar.view.html',
                link: function(scope, element) {
                    var url = $location.url();
                    var route = url.split('/');
                    scope.$watch('links', function(){
                        $timeout(function() {
                            $(element).find('a[href="#/' + route[1] + '"]').parent().addClass('open');
                        }, 200);
                    });
                }
            };
        });
})();
(function() {
    'use strict';

    /**
     * 左侧导航(数据访问层)
     */
    angular
        .module('pasp.ui.seed')
        .service('SidebarService', function($http, $q) {
            // 获取导航数据
            this.get = function(category) {
                var deferred = $q.defer();
                $http.get('api/nav/' + category + '.json',{})
                    .success(function(data) {
                        deferred.resolve(data.data);
                    }).error(function(data) {
                        deferred.reject(data);
                    });

                return deferred.promise;
            };
        });
})();

(function() {
    'use strict';
    
    /**
     * 控制器
     */
    angular.module('pasp.ui.seed')
        .controller('ConfirmDialogCtrl', function($modalInstance, $scope) {
            // 确定
            $scope.save = function() {
                $modalInstance.close();
            };

            // 取消
            $scope.cancel = function () {
                $modalInstance.dismiss('cancel');
            };
        });
})();
(function() {
    'use strict';

    angular
        .module('pasp.ui.seed')
        .provider('ConfirmDialog', function() {
            
            this.options = {
                templateUrl: 'scripts/components/confirm-dialog/confirm-dialog.view.html',
                controller: 'ConfirmDialogCtrl',
                windowClass: 'confirm-dialog'
            };

            this.$get = function($uiModal) {
                var options = this.options;
                var open = function() {
                    var modalInstance = $uiModal.open({
                        templateUrl: options.templateUrl,
                        controller: options.controller,
                        windowClass: options.windowClass
                    });

                    return modalInstance.result;
                };

                return {
                    open: open
                };
            };
        });
})();
(function() {
    'use strict';

    /**
     * 控制器
     */
    angular.module('pasp.ui.seed')
        .controller('HomeCtrl', function($scope) {
            $scope.title = "欢迎使用PASP UI";
            $scope.content = "开始使用PASP UI搭建WEB项目。";
        });
})();

(function() {
    'use strict';

    /**
     * 控制器
     */
    angular.module('pasp.ui.seed')
        .controller('TableCtrl', function($scope, ConfirmDialog, Notification) {
            $scope.page = {
                currentPage: 1
            };

            // 删除
            $scope.delete = function() {
                ConfirmDialog.open().then(function () {
                    Notification.success('删除成功！');
                });
            };    
        });
})();

(function() {
    'use strict';

    /**
     * 控制器
     */
    angular.module('pasp.ui.seed')
        .controller('FormCtrl', function($scope) {
            $scope.data = {};    
        });
})();
